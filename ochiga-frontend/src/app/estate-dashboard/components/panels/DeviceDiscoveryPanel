import { useState, useEffect } from "react";

type Device = { id: string; name: string; type: string };

interface DeviceDiscoveryPanelProps {
  estateId: string;
  homeId: string;
}

export default function DeviceDiscoveryPanel({ estateId, homeId }: DeviceDiscoveryPanelProps) {
  const [devices, setDevices] = useState<Device[]>([]);

  useEffect(() => {
    // TODO: fetch devices from backend using estateId
    async function fetchDevices() {
      try {
        const res = await fetch(`/api/estate/${estateId}/devices`);
        const data = await res.json();
        setDevices(data);
      } catch (err) {
        console.error("Failed to fetch devices", err);
      }
    }

    if (estateId) fetchDevices();
  }, [estateId]);

  return (
    <div className="space-y-2">
      <h3 className="text-lg font-semibold mb-2">Device Discovery</h3>
      <p>Home ID: {homeId}</p>
      {devices.length ? (
        <ul className="space-y-1">
          {devices.map((d) => (
            <li key={d.id} className="p-2 border rounded">
              {d.name} ({d.type})
            </li>
          ))}
        </ul>
      ) : (
        <p>No devices found. Start scanning your estate.</p>
      )}
    </div>
  );
}
